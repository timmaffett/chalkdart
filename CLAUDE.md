# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

ChalkDart is a pure Dart library for console/logging text coloring and styling. It supports two output modes: ANSI (terminal) and HTML (web/logging). Inspired by Chalk.js. Published on pub.dev as `chalkdart`.

## Common Commands

```bash
# Run tests
dart test

# Run a single test file
dart test test/chalkdart_test.dart

# Analyze code
dart analyze

# Run examples
dart run example/chalkdart_example.dart
dart run example/chalkdart_example.dart --html --dark   # HTML output mode

# Code generation - regenerate X11/CSS color methods
dart run tool/make_css_x11_methods.dart -c   # Chalk class extensions -> lib/src/chalk_x11.g.dart
dart run tool/make_css_x11_methods.dart -s   # String extensions -> lib/src/chalkstrings_x11.g.dart

# Get dependencies
dart pub get
```

## Architecture

### Dual Output Modes
The library has two output backends selected via `ChalkOutputMode`:
- **ANSI mode** (default): Emits ANSI escape sequences for terminals. Core logic in `lib/src/chalk.dart`.
- **HTML mode**: Emits `<span>` tags with inline CSS. Core logic in `lib/src/chalk_html.dart` (~4600 lines, the largest file).

### Library Entry Points (lib/)
- `chalkdart.dart` — Full library: Chalk class + string extensions + X11 colors
- `chalk.dart` — Core Chalk class only (no string extensions)
- `chalkstrings.dart` — String extension methods
- `chalk_x11.dart` / `chalkstrings_x11.dart` — X11/CSS named color extensions
- `colorutils.dart` — Color space conversions (RGB, HSL, HSV, HWB, XYZ, LAB)

### Code Generation
Files ending in `.g.dart` are generated by `tool/make_css_x11_methods.dart`. This generates ~140+ named color methods for both the Chalk class and String extensions. Do not hand-edit `.g.dart` files; modify the generator instead.

### Platform Conditional Imports
ANSI support detection uses Dart conditional imports:
- `lib/src/supports_ansi.dart` (default stub)
- `lib/src/supports_ansi_io.dart` (dart:io platforms)
- `lib/src/supports_ansi_web.dart` (web/JS/Wasm)

### API Patterns
Two equivalent APIs — fluent Chalk chaining and String extensions:
```dart
chalk.yellow.onBlue.bold('text');       // Chalk API
'text'.yellow.onBlue.bold;              // String extension API
```

## Code Style

- Formatter page width is 160 (set in `analysis_options.yaml`)
- Uses `package:lints/recommended.yaml` for analysis
- No runtime dependencies — pure Dart library
- SDK constraint: `>=3.0.0 <4.0.0`
